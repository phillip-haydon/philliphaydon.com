<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta http-equiv="last-modified" content="2014-01-31T16:14:58.7712296+08:00" />
    <title>philliphaydon.com</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
    <link rel="canonical" href="http://www.philliphaydon.com/page8/" />
</head>
<body class="home blog">
    <div id="page" class="hfeed site">
        <header id="masthead" class="site-header fancy-container lightgreen" role="banner">
            <hgroup>
                <h1 class="site-title"><a href="/" title="philliphaydon.com" rel="home">philliphaydon.com</a></h1>
                <h2><small>Works on my PC...</small></h2>
                <p class="site-description">Pleb from New Zealand who was banished overseas and currently resides in Singapore.</p>
            </hgroup>
            <nav role="navigation" class="site-navigation main-navigation">
                <h1 class="assistive-text">Menu</h1>
                <div class="assistive-text skip-link"><a href="#content" title="Skip to content">Skip to content</a></div>
                <div class="menu">
                    <ul>
                        <li><a href="/about">About</a></li>
                        <li><a href="/category">Categories</a></li>
                        <li><a href="/archive">Archive</a></li>
                        <li><a href="/feed.xml">RSS / Feed</a></li>
                    </ul>
                </div>
            </nav>
        </header>
        <div id="main">
            <div id="primary" class="site-content">
                <div id="content" role="main">
                  

  <ul class="posts">
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/12/ravendb-inheritance-revisited/">RavenDB Inheritance-Revisited</a> 
        <span>posted on 14 Dec 2011</span>
      </h1> 
      
      <p>So after my initial post on <a href="/2011/12/ravendb-inheritance/">RavenDB Inheritance</a>, and the issue I had with polymorphic queries, and seeking help from the guys in <a href="http://jabbr.net/">JabbR</a> and the (RavenDB Google Group)[http://groups.google.com/group/ravendb/browse_thread/thread/c71df8f1cd92e04c], <a href="http://ayende.com/blog/">Ayende</a> ended up doing a screen cast with me where he solved all my problems.</p>

<p>One of the things he asked me was what I was trying to achieve by having a polymorphic query, which was a very good question, something I hadn't really thought about.</p>

<p>The problem I was trying to solve was actually displaying search results.</p>

<h2>The Problem</h2>

<p>So I'm working on a personal project, and I need to display a few things which are similar, but different. There's 3 different types but I'll use two to keep it simple. I've also cut out most of the properties.</p>

<p>So I have an abstract class Content, with two derived classes, Article and Video.</p>

<pre><code>public abstract class Content
{
    public int Id { get; set; }
    public string Title { get; set; }
    public DateTime DatePublished { get; set; }
}

public class Article : Content
{
    public string HtmlContent { get; set; }
}

public class Video : Content
{
    public string Description { get; set; }
    public string VideoUrl { get; set; }
}
</code></pre>


      <p><a href="/2011/12/ravendb-inheritance-revisited/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/12/ravendb-inheritance/">RavenDB Inheritance</a> 
        <span>posted on 10 Dec 2011</span>
      </h1> 
      
      <p><span class="note"><strong>Note:</strong> Updated solution: <a href="http://www.philliphaydon.com/2011/12/ravendb-inheritance-revisited/">http://www.philliphaydon.com/2011/12/ravendb-inheritance-revisited/</a></span></p>

<p>Continuing my learning of RavenDB, I wanted to see how it handled Inheritance.</p>

<p>I found: <a href="http://ravendb.net/faq/polymorphic-indexes">http://ravendb.net/faq/polymorphic-indexes</a></p>

<p>Which showed what to do allow you to select over all types of <code>Animal</code> for the example shown. So I wanted to see what happens before and after using this method.</p>

<p>So like the example shown I've created an <code>Animal</code>, with a <code>Dog</code> and <code>Cat</code>.</p>

<pre><code>public abstract class Animal
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class Dog : Animal { }

public class Cat : Animal { }
</code></pre>

<p>Now if I insert a Dog and Cat:</p>

<pre><code>using (var session = documentStore.OpenSession())
{
    session.Store(new Dog() { Name = "Test Dog" });
    session.Store(new Cat() { Name = "Test Cat" });
    session.SaveChanges();
}
</code></pre>


      <p><a href="/2011/12/ravendb-inheritance/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/12/post-a-collection-of-viewmodels-to-a-mvc-action-with-jquery/">Post a collection of ViewModel's to a MVC Action with jQuery</a> 
        <span>posted on 07 Dec 2011</span>
      </h1> 
      
      <p>Maybe I searched for the wrong thing, but I couldn't find what I was looking for :( My Bing and Google fu failed me.</p>

<p>Basically I wanted to post a collection of ViewModels to an MCV action. Turns out it's rather simple.</p>

<p>Lets say I have a bunch of Products, and Products are managed in a WarehouseLocation. A product doesn't have a warehouse location, since it could exist in multiple locations.</p>

<p>If I'm currently working in Location A, I want to post a collection of Products to an action, as well as the WarehouseLocationId.</p>

<p>So given a simple ViewModel, and an Action:</p>

<pre><code>public class ProductViewModel
{
    public int Id { get; set; }
    public string Name { get; set; }
    public decimal Price { get; set; }
}
</code></pre>

<p>and</p>


      <p><a href="/2011/12/post-a-collection-of-viewmodels-to-a-mvc-action-with-jquery/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/11/optional-parameters-with-attributerouting/">Optional Parameters with AttributeRouting</a> 
        <span>posted on 27 Nov 2011</span>
      </h1> 
      
      <p>I found a little trick with using Optional Parameters with <a href="https://github.com/mccalltd/AttributeRouting/wiki/2.-Usage">AttributeRouting</a>, by using standard optional parameters in the action.</p>

<p>The documentation says you can add an attributes to specify the defaults, or add <code>=value</code> to the parameter name, and I guess that's a more correct way to generate routes, but you can achieve the same affect by making the parameter optional. Like so:</p>

<pre><code>[GET("videos/{?page}")]
public ActionResult Videos(int page = 1)
{
    return View("Result");
}
</code></pre>

<p>If I browse to the URL:</p>

<p><img src="/images/attribute-routing-1.png" alt="" /></p>

<p>It uses the default value of 1.</p>

<p><img src="/images/attribute-routing-2.png" alt="" /></p>

<p>Now when appending a number to the end of the URL:</p>


      <p><a href="/2011/11/optional-parameters-with-attributerouting/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/11/split-windows-web-workbench-win/">Split Windows + Web Workbench = Win</a> 
        <span>posted on 27 Nov 2011</span>
      </h1> 
      
      <p>One of the cool features of the <a href="http://www.mindscapehq.com/products/web-workbench/">Web Workbench</a> from Mindscape is the ability to generate the output files. Prior to using the Web Workbench I was using <a href="http://www.dotlesscss.org/">.LESS{}</a> which uses an HTTP Handler to generate the output files for LESS.</p>

<p>The problem with this is sometimes I would write some CSS and not realise I missed something only to find my site doesn't display anything, then I have to figure out what I did wrong.</p>

<p>With the Web Workbench, and it's ability to generate the files every time I save, makes me less error prone.</p>

<p>But the most efficient way of working with it I found (when writing a lot of CSS in 1 sitting) is to split my windows so the first window has where I'm writing, and the second window has the generated CSS file.</p>

<p><img src="/images/split-screen-1.png" alt="" /></p>

<p>If I make an error on the left side:</p>

<p><img src="/images/split-screen-2.png" alt="" /></p>

<p>I see the error on the right.</p>

<p>If I make a change to the left, (added a background colour) i see the change on the right.</p>


      <p><a href="/2011/11/split-windows-web-workbench-win/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/11/unit-of-work-with-wcf-and-autofac/">Unit of Work with WCF and Autofac</a> 
        <span>posted on 06 Nov 2011</span>
      </h1> 
      
      <p>I've just spent the last few days trying to find a way to have a Unit of Work with WCF, but it seems no one has a nice clean easy solution.</p>

<p>The first, and the only decent solution I found was here:</p>

<p><a href="http://ianfnelson.com/archives/2010/04/09/wcf-nhibernate-unit-of-work-endpoint-behavior">http://ianfnelson.com/archives/2010/04/09/wcf-nhibernate-unit-of-work-endpoint-behavior</a></p>

<p>The problem I found with this solution is that the ICallContextInitializer as well as the EndpointBehavior is only created once. So it would seem all calls to a service would share the same Unit of Work instance.</p>

<p>Maybe Castle Windsor does something fancy and injects a brand new <code>EndpointBehavior</code> every request to a service, but for me, it seemed the <code>ServiceBehavior</code>, <code>EndpointBehavior</code>, and <code>ICallContextInitializer</code> were all created once.</p>

<p>This caused my service to resolve a different instance of <code>IUnitOfWork</code> to what was in the <code>ICallContextInitializer</code>.</p>

<h2>Interim Solution 1</h2>

<p>The first solution I came up with was to use Autofac to call Commit on release:</p>

<pre><code>builder.RegisterType(typeof (UnitOfWork))
        .As(typeof (IUnitOfWork))
        .InstancePerLifetimeScope()
        .OnRelease(x =&gt;
                        {
                            ((IUnitOfWork) x).Commit();
                        });
</code></pre>


      <p><a href="/2011/11/unit-of-work-with-wcf-and-autofac/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/11/windows-phone-windows-live-and-msn/">Windows Phone, Windows Live and MSN</a> 
        <span>posted on 02 Nov 2011</span>
      </h1> 
      
      <p>Windows Phone 7.5 has been getting some awesome reviews, and rightly so. The thing is amazing. I really think Microsoft has begun leading the way for the mobile platform.</p>

<p>But I'm highly pissed off with the Windows Phone team. Why? <strong>Because to use MSN, your msn contacts must be associated with the first live account you register to the phone.</strong></p>

<p>I don't even know what to say about this, it's so silly. I understand that it might get confusing to allow multiple Facebook accounts, multiple Windows Live accounts, etc.</p>

<p>But could they not allow you to choose which account MSN contacts are associated to?</p>

<p>When I first setup my phone I didn't use the Windows Live account I use for MSN (my Hotmail) since it's existed since 1997, it's got 100's of contacts I don't want in my phone-book, a lot of MSN contacts exist from work, or playing online games, or from forums etc. So I used the Windows Live account that I use for MSDN. I added all my contacts and everything was great, (after I imported all my contacts from outlook into Windows Live Contacts)</p>


      <p><a href="/2011/11/windows-phone-windows-live-and-msn/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/10/ravendb-changing-the-lo-on-the-hilo-generator/">RavenDB - Changing the Lo on the HiLo Generator</a> 
        <span>posted on 24 Oct 2011</span>
      </h1> 
      
      <p>Well I'm currently learning RavenDB, it's awesome! But I noticed when I put data in, all the Id's generated every time I ran up my application to test were:</p>

<p>1, 2, 3, 4, 5...</p>

<p>1024, 1025, 1026, 1027, 1028...</p>

<p>2048, 2049, 2050, 2051, 2052...</p>

<p>This would be fine after the app is deployed since I wouldn't be restarting it over and over and over, but during development I personally find it annoying that the numbers jump so high.</p>

<p>Fortunately I figured out a way. (which about an hour later I found on Google Groups, granted I had to use a different keyword to find it)</p>

<p>Basically you just need to create a new instance of the <code>MultiTypeHiLoKeyGenerator</code> class, passing in the arguments and assigning it to the document store:</p>

<pre><code>var documentStore = (new DocumentStore { 
    Url = "http://localhost:12321/" 
}).Initialize();

var generator = new MultiTypeHiLoKeyGenerator(documentStore, 10);

documentStore.Conventions.DocumentKeyGenerator = 
    entity =&gt; generator.GenerateDocumentKey(documentStore.Conventions, entity);

using (var session = documentStore.OpenSession())
{
    session.Store(new Project() { Title = "Hello World" });
    session.SaveChanges();
}
</code></pre>

<p>So running up my app once:</p>


      <p><a href="/2011/10/ravendb-changing-the-lo-on-the-hilo-generator/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/10/nhibernate-designer-2/">NHibernate Designer 2</a> 
        <span>posted on 20 Oct 2011</span>
      </h1> 
      
      <p>The guys at MindScape have released their next version of NHibernate Designer, which now supports Fluent NHibernate and a whole heap of new features.</p>

<p>They also dropped the price down to just $99!</p>

<p>I recommend checking it out</p>

<p><a href="http://www.mindscapehq.com/blog/index.php/2011/10/19/nhibernate-designer-2-is-here/">http://www.mindscapehq.com/blog/index.php/2011/10/19/nhibernate-designer-2-is-here/</a></p>

<p><a href="http://www.mindscapehq.com/products/nhdesigner">http://www.mindscapehq.com/products/nhdesigner</a></p>

      <p><a href="/2011/10/nhibernate-designer-2/">Read more...</a></p>
    </li>
    <li class="fancy-container lightblue">
      <h1>
        <a href="/2011/10/website-folder-structure-css-files-does-anyone-care-i-do/">Website Folder Structure? CSS Files? Does anyone care? I do...</a> 
        <span>posted on 17 Oct 2011</span>
      </h1> 
      
      <p>When we build website's, more often than not we have: Separation of Concerns. Even if at most it's just basic 3-tier Architecture</p>

<p>What annoys me though is a lot of time no one ever thinks about separation of concerns when it comes to the folder structure of their website, and where things go.</p>

<h2>Folders</h2>

<p>The one thing that annoys me above all else, is when 'layout images' (images for layout, design, styling etc) of the website, are shoved into the same folder that holds what I call "Content Images".</p>

<p>For example:</p>

<pre><code>root/ 
root/css/ 
root/images/
</code></pre>

<p>What I prefer to do is structure it so the css folder has it's own images folder, specifically for layout images.</p>

<pre><code>root/ 
root/css/ 
root/css/images/ 
root/images
</code></pre>


      <p><a href="/2011/10/website-folder-structure-css-files-does-anyone-care-i-do/">Read more...</a></p>
    </li>
  </ul> 

  <!-- Pagination links -->
  <div id="post-pagination" class="pagination">

   
      <p class="previous">
        <a href="/page7">Previous Page</a>
        </p>


    <p class="previous">
      <a href="/page9">Next Page</a>
    </p>

  </div>


                </div>
                <!-- #content -->
            </div>
            <!-- #primary .site-content -->

            <div id="secondary" class="widget-area fancy-container lightred" role="complementary">
                <aside id="text-5" class="widget widget_text">
                    <h1 class="widget-title">Follow</h1>
                    <div class="textwidget logos">
                        <a href="https://twitter.com/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://twitter.com']);"><img src="/stylesheets/images/twitter.png"></a>
                        <a href="http://stackoverflow.com/users/456813/phill" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://stackoverflow.com']);"><img src="/stylesheets/images/stackoverflow.png"></a>
                        <a href="http://www.linkedin.com/in/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://www.linkedin.com']);"><img src="/stylesheets/images/linkedin.png"></a>
                        <a href="https://plus.google.com/u/0/111751877537461442095" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://plus.google.com']);"><img src="/stylesheets/images/googleplus.png"></a>
                        <a href="https://coderbits.com/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','https://coderbits.com/philliphaydon']);"><img src="/stylesheets/images/codebits.png"></a>
                        <a href="https://github.com/phillip-haydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://github.com']);"><img src="/stylesheets/images/github.png"></a>
                        <a href="http://www.codeschool.com/users/philliphaydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://codeschool.com']);"><img src="/stylesheets/images/codeschool.png"></a>
                        <a href="http://www.kickstarter.com/profile/phillip-haydon" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://kickstarter.com']);"><img src="/stylesheets/images/kickstarter.png"></a>
                    </div>
                    <a href="http://stackoverflow.com/users/456813/phill">
                      <img src="http://stackoverflow.com/users/flair/456813.png" width="208" height="58" alt="profile for Phill at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Phill at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
                    </a>
                    
                    <a href="http://nancyfx.org/mvm.html"><img src="/stylesheets/images/mvm.png"></a>
                    
                    <div id = "clustrback" style="width:162px; height:133px;  background:#f7f7f7 url(http://clustrmaps.com/admin/3d/images/st4_grey.png)  center no-repeat; text-align:center;">
                      <a href="http://www2.clustrmaps.com/counter/maps.php?url=http://www.philliphaydon.com/" style="width:160px; display:block; margin:0 auto;" id="clustrMapsLink">
                        <img src="http://www2.clustrmaps.com/counter/index2.php?url=http://www.philliphaydon.com/" style="border:0px; margin:15px auto;margin:15px auto;" alt="Locations of visitors to this page" title="Locations of visitors to this page" id="clustrMapsImg" />
                      </a>
                    </div>
                </aside>
                <!--aside id="text-8" class="widget widget_text">
                    <h1 class="widget-title">Other sites</h1>
                    <div class="textwidget">
                        <a href="http://csharptube.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://csharptube.com']);">csharptube.com</a><br />
                        <a href="http://thisisparrot.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://thisisparrot.com']);">Parrot</a><br />
                        <a href="http://shitprogrammerswrite.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://shitprogrammerswrite.com']);">Shit programmers write</a><br />
                    </div>
                </aside-->
                <aside id="linkcat-6" class="widget widget_links">
                    <h1 class="widget-title">Other Blogs</h1>
                    <ul class='xoxo blogroll'>
                        <li><a href="http://www.nickharris.net/" target="_top" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://nickharris.net/']);">Nick Harris</a></li>
                        <li><a href="http://www.mindscapehq.com/blog/" target="_top" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://www.mindscapehq.com/blog/']);">Mindscape</a></li>
                        <li><a href="http://blog.orangelightning.co.uk/" target="" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://blog.orangelightning.co.uk/']);">Phil Jones</a></li>
                        <li><a href="http://buildstarted.com/" target="" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://buildstarted.com']);">Ben Dornis</a></li>
                        <li><a href="http://jflood.net/" target="" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://jflood.net/']);">Jospeh Flood</a></li>
                    </ul>
                    
                </aside>
                <aside id="archives-4" class="widget widget_archive">
                    <h1 class="widget-title">Archive</h1>
                    <ul class="posts">
                          <li><a href="/archive#2014January">January, 2014</a></li>
                          <li><a href="/archive#2013December">December, 2013</a></li>
                          <li><a href="/archive#2013November">November, 2013</a></li>
                          <li><a href="/archive#2013October">October, 2013</a></li>
                          <li><a href="/archive#2013September">September, 2013</a></li>
                          <li><a href="/archive#2013August">August, 2013</a></li>
                          <li><a href="/archive#2013July">July, 2013</a></li>
                          <li><a href="/archive#2013June">June, 2013</a></li>
                          <li><a href="/archive#2013May">May, 2013</a></li>
                          <li><a href="/archive#2013April">April, 2013</a></li>
                          <li><a href="/archive#2013March">March, 2013</a></li>
                          <li><a href="/archive#2013February">February, 2013</a></li>
                          <li><a href="/archive#2013January">January, 2013</a></li>
                          <li><a href="/archive#2012December">December, 2012</a></li>
                          <li><a href="/archive#2012November">November, 2012</a></li>
                          <li><a href="/archive#2012October">October, 2012</a></li>
                          <li><a href="/archive#2012September">September, 2012</a></li>
                          <li><a href="/archive#2012July">July, 2012</a></li>
                          <li><a href="/archive#2012June">June, 2012</a></li>
                          <li><a href="/archive#2012April">April, 2012</a></li>
                          <li><a href="/archive#2012March">March, 2012</a></li>
                          <li><a href="/archive#2012February">February, 2012</a></li>
                          <li><a href="/archive#2012January">January, 2012</a></li>
                          <li><a href="/archive#2011December">December, 2011</a></li>
                          <li><a href="/archive#2011November">November, 2011</a></li>
                          <li><a href="/archive#2011October">October, 2011</a></li>
                          <li><a href="/archive#2011September">September, 2011</a></li>
                          <li><a href="/archive#2011August">August, 2011</a></li>
                          <li><a href="/archive#2011July">July, 2011</a></li>
                          <li><a href="/archive#2011June">June, 2011</a></li>
                          <li><a href="/archive#2011May">May, 2011</a></li>
                          <li><a href="/archive#2011April">April, 2011</a></li>
                          <li><a href="/archive#2011March">March, 2011</a></li>
                          <li><a href="/archive#2011February">February, 2011</a></li>
                          <li><a href="/archive#2011January">January, 2011</a></li>
                          <li><a href="/archive#2010December">December, 2010</a></li>
                          <li><a href="/archive#2010November">November, 2010</a></li>
                          <li><a href="/archive#2010October">October, 2010</a></li>
                          <li><a href="/archive#2010September">September, 2010</a></li>
                          <li><a href="/archive#2009July">July, 2009</a></li>
                    </ul>
                </aside>
            </div>
            <!-- #secondary .widget-area -->


        </div>
        <!-- #main -->

        <footer id="colophon" class="site-footer" role="contentinfo">
            <div class="site-info">
                Powered by <a href="https://github.com/Sandra/Sandra.Snow" rel="generator">Sandra.Snow v1.3.0</a>.	
            </div>
            <!-- .site-info -->
        </footer>
        <!-- #colophon .site-footer -->
    </div>
    <!-- #page .hfeed .site -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src='/javascripts/prettify.js' type='text/javascript'></script>
    
    <script type="text/javascript">
var _gaq = _gaq || [];

_gaq.push(['_setAccount', 'UA-655975-13']);
_gaq.push(['_trackPageview']);
        
(function () {
    var ga = document.createElement('script');
    ga.type = 'text/javascript';
    ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(ga, s);
})();
</script>
    
    <script type='text/javascript'>
      $(function () {
        $("pre code").parent().each(function () {
          if (!$(this).hasClass("prettyprint")) {
            $(this).addClass("prettyprint");
            a = true
          }
        });

        prettyPrint();
      });
    </script>
</body>
</html>
